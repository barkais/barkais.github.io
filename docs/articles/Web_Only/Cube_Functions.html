<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="moleculaR">
<title>Cube Functions • moleculaR</title>
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="Cube Functions">
<meta property="og:description" content="moleculaR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../../index.html">moleculaR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../../articles/Web_Only/Command_Line_Usage.html">Command Line Usage</a>
    <a class="dropdown-item" href="../../articles/Web_Only/Cube_Functions.html">Cube Functions</a>
    <a class="dropdown-item" href="../../articles/Web_Only/Getting_Started_with_Examples.html">Getting Started with Examples</a>
    <a class="dropdown-item" href="../../articles/Web_Only/Modeling.html">Modeling</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Cube Functions</h1>
            
      
      
      <div class="d-none name"><code>Cube_Functions.Rmd</code></div>
    </div>

    
    
<hr>
<div class="section level2">
<h2 id="download-example-cube-files">Download example cube files<a class="anchor" aria-label="anchor" href="#download-example-cube-files"></a>
</h2>
<p>Please find the example cube files on the package’s <a href="https://github.com/barkais/moleculaR/blob/main/Cube%20Functions/Example_cube_files.zip" class="external-link">Github</a></p>
<p>Once downloaded and unzipped, you are ready to go!</p>
<p>For user convenience, we demonstrate usage with a small number of
molecules, such that downloading the log files directly to a local
machine will stay within memory-usage reason.</p>
<p>As with other cases of 3D visualizations in moleculaR, the 3D visual
tool that is supplied by <code><a href="../../reference/steRimol.cube.html">steRimol.cube()</a></code> is hard to use on
Linux systems without sudo access. Though this shouldn’t prevent users
from running this on Linux systems, just that visualizations are not
guaranteed to work smoothly.</p>
<blockquote>
<p><strong>Using cube functionalities requires setting the working
directory to that holding at least one cube file. In cases where more
than file is to be analyzed, all files should be in the same
loctaion.</strong></p>
</blockquote>
<hr>
<pre><code><span><span class="co"># Load moleculaR</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">moleculaR</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set you working directory to that of the cube files</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span><span class="st">'path/to/cube/files'</span><span class="op">)</span></span></code></pre>
<p>The generation of sterimol values from density cube files is similar
in nature to the classic, xyz-based sterimol. The key difference between
the two is the reliance of the classic computation on tabulated radii
data, which do not account for stereo-electronic variations in atomic
radii. Thus, by using tabulated data, one assumes that the changing
electronic structure of the molecule, does not affect the atomic radii,
which is not accurate, to say he least.</p>
<p>The cube based sterimol tool seeks to face this issue by achieving a
more subtle representation of sterimol values - with this, even values
of unchanged substructures in two different molecules, will show
variation in results.</p>
<p>For example, using the supplied cube files, measuring sterimol values
using steRimol.xyz along the primary axis 1-15, yields the exact same
results for B1, and very close results for B5 and L (that have slight
variations caused by the non-subtle changes to the structures in
optimization). This is due to the fact that the substructure that
follows this primary axis is consistent in all of the molecules.
<strong>Usage of functions will be explained later on.</strong></p>
<center>
<img src="../../reference/figures/cdx.png" width="152" height="180">
</center>
<pre><code><span><span class="co"># Make xyz files from cube files:</span></span>
<span><span class="fu"><a href="../../reference/xyz.from.cube.html">xyz.from.cube</a></span><span class="op">(</span><span class="st">'Ad.cube'</span><span class="op">)</span></span>
<span><span class="fu"><a href="../../reference/xyz.from.cube.html">xyz.from.cube</a></span><span class="op">(</span><span class="st">'Bn.cube'</span><span class="op">)</span></span>
<span><span class="fu"><a href="../../reference/xyz.from.cube.html">xyz.from.cube</a></span><span class="op">(</span><span class="st">'Cy.cube'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Measure sterimol values for primary axis 1-15</span></span>
<span><span class="fu"><a href="../../reference/steRimol.xyz.multi.html">steRimol.xyz.multi</a></span><span class="op">(</span><span class="st">'1 15'</span>, CPK <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre>
<p>Gives:</p>
<pre><code>       B1_1 B5_1  L_1 loc.B5_1 loc.B1_1
Ad.xyz  1.7 3.28 7.04     4.06     3.22
Bn.xyz  1.7 3.26 7.03     4.07     3.22
Cy.xyz  1.7 3.23 7.03     4.10     3.22</code></pre>
<p>Now do the same with steRimol.cube:</p>
<pre><code><span><span class="co"># Compute cube steRimols with:</span></span>
<span><span class="fu"><a href="../../reference/steRimol.cube.df.html">steRimol.cube.df</a></span><span class="op">(</span><span class="st">'1 15'</span><span class="op">)</span></span></code></pre>
<p>Which gives:</p>
<pre><code>       B1     B5      L loc.B5 loc.B1 time.taken
Ad 1.6473 3.4252 6.9813 1.7597 3.1770     7.6715
Bn 1.6436 3.5738 7.2337 4.1364 1.8079     7.1501
Cy 1.6637 3.3260 6.9240 4.0382 1.2983     7.6851</code></pre>
<p>With this logic, it actually makes sense to evaluate even the
unchanged substructures of molecular libraries, as it depicts the
subtleties in stereo-electronic variations due to changing
substituents.</p>
<p><strong>It is important to note that the steRimol.cube
functionalities are left out of the moleculaR workflow, as they require
users to generate cube files independently, and placing all of them in a
designated folder, to prevent unnecessarily heavy file
transfers.</strong></p>
<blockquote>
<p><strong>Isovalues:</strong></p>
<p>steRimol.cube searches for density regions within a certain range of
densities, which essentially depend on what we, as users, define the
radius to be.</p>
<p>Generally speaking, we found that a value of ~0.003
e<sup>-</sup>/bohr<sup>3</sup> fits sterimol values using CPK radii,
while a much higher value of ~0.035 e<sup>-</sup>/bohr<sup>3</sup> fits
with Pyykko’s covalent radii. Users are incouraged to play around with
isovalues, as we believe there is some chemical knowledge underlying
these differences, which could be benefitial in the realm of mechanistic
investigations and statistical analyses.</p>
</blockquote>
</div>
<div class="section level2">
<h2 id="extract-sterimol-cube-values-for-a-single-cube-file">Extract steRimol.cube values for a single cube file<a class="anchor" aria-label="anchor" href="#extract-sterimol-cube-values-for-a-single-cube-file"></a>
</h2>
<p>Using this functionality also allows the visualization of the chosen
molecule and of the computed B1, B5 and L axes.</p>
<pre><code><span><span class="co"># For example, extracting sterimol values for the file Bn.cube, along the axis of 1-3:</span></span>
<span><span class="fu"><a href="../../reference/steRimol.cube.html">steRimol.cube</a></span><span class="op">(</span>cubefile <span class="op">=</span> <span class="st">'Bn.cube'</span>,</span>
<span>              coordinates <span class="op">=</span> <span class="st">'1 3'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Actually implies:</span></span>
<span><span class="fu"><a href="../../reference/steRimol.cube.html">steRimol.cube</a></span><span class="op">(</span>cubefile <span class="op">=</span> <span class="st">'Bn.cube'</span>,</span>
<span>              coordinates <span class="op">=</span> <span class="st">'1 3'</span>,</span>
<span>              only.sub <span class="op">=</span> <span class="cn">T</span>, </span>
<span>              drop <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>              plot <span class="op">=</span> <span class="cn">T</span>,</span>
<span>              degrees <span class="op">=</span> <span class="fl">90</span>,</span>
<span>              isovalue <span class="op">=</span> <span class="fl">0.003</span><span class="op">)</span></span></code></pre>
<p>Gives:</p>
<pre><code>      B1     B5      L loc.B5 loc.B1 time.taken
1 1.7405 6.0796 4.4315 3.2115 1.9695     7.1286</code></pre>
<p>Using <code>plot = T</code> also produces a 3D visualization of the
molecule:</p>
<center>
<img src="../../reference/figures/cube_sterimol.png" width="400" height="365">
</center>
<ul>
<li><p>The dots around the molecule are coordinates in which electron
density is in the range from the defined isovalue + 10%. Black painted
dots imply the substructure designated by <code>sub_only = T</code>,
while gray dots are the rest.</p></li>
<li><p>Sterimol axes are added as arrows - blue (L), green (B5), and red
(B1).</p></li>
<li><p>The <code>degrees</code> argument is changeable, but there is no
benefit in changing it, rather it is there to ease validations. It is
set to 90 degrees as this is a full 360˚ scan (to the degree), as with
each 1 degree rotation, all 4 directions are accounted for. It is
advised to use the default value.</p></li>
<li><p>The rest of the arguments are used exactly as with the classic
<code>steRimol.xyz</code> and <code>steRimol</code> families.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="extracting-sterimol-cube-values-for-a-set-of-cube-files">Extracting steRimol.cube values for a set of cube files<a class="anchor" aria-label="anchor" href="#extracting-sterimol-cube-values-for-a-set-of-cube-files"></a>
</h2>
<p>For example, using the cube files we have, producing steRimol.cube
values along the axis of 1-2:</p>
<pre><code><span><span class="fu"><a href="../../reference/steRimol.cube.df.html">steRimol.cube.df</a></span><span class="op">(</span><span class="st">'1 2'</span><span class="op">)</span></span></code></pre>
<p>Gives:</p>
<pre><code>       B1     B5      L loc.B5 loc.B1 time.taken
Ad 3.1523 3.7729 6.5829 4.0966 0.2460     8.7802
Bn 1.7405 6.0796 4.4315 3.2115 1.9695     6.8076
Cy 2.0178 3.7576 6.4470 3.9580 1.0763     8.3365</code></pre>
<p>Visualization is not available for multiple files. To add
visualization, first use the single file functionality.</p>
</div>
<div class="section level2">
<h2 id="generating-an-xyz-from-a-cube-file">Generating an xyz from a cube file<a class="anchor" aria-label="anchor" href="#generating-an-xyz-from-a-cube-file"></a>
</h2>
<p>A simple function, needed for different reasons. Existing xyz files
will be removed by <code><a href="../../reference/steRimol.cube.html">steRimol.cube()</a></code> and
<code><a href="../../reference/steRimol.cube.df.html">steRimol.cube.df()</a></code> once executed.</p>
<pre><code><span><span class="fu"><a href="../../reference/xyz.from.cube.html">xyz.from.cube</a></span><span class="op">(</span><span class="va">cube_file</span><span class="op">)</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Shahar Barkai.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
